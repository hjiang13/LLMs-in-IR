Count the distinct characters in a given C++ string while handling memory allocation and potential exceptions.